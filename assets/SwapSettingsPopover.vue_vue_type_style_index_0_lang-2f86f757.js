import{cm as G,aq as L,b5 as H,aP as U,aY as q,aZ as Y,au as $,b2 as K,bz as Q,cl as M,bP as j,ao as J,aw as Z,bJ as X}from"./BalBtn-a3a093af.js";import{u as N,c as C,av as ee}from"./connector-d867b6ec.js";import{d as V,a4 as te}from"./index-c7e2fe85.js";import{q as w,v as O,r as A,p as se,d as ae,ai as ne,b as k,c as oe,l as d,D as i,h as o,y as t,A as b,B as le,x as P,af as B,f as D,w as re}from"./runtime-core.esm-bundler-24a2b16f.js";import{w as ie,t as ce,C as ue}from"./useTransactions-19512b92.js";import{u as pe,b as de}from"./useGnosisSafeApp-4db73fba.js";import{i as me,A as ve,e as _e,u as fe}from"./options-bcf19abd.js";import{_ as ge}from"./BalPopover-e1e06c58.js";import{_ as ye}from"./BalToggle-35e11638.js";import{_ as xe}from"./BalBtnGroup-31269ec8.js";import{_ as he}from"./BalTooltip.vue_vue_type_style_index_0_lang-b52dcfa5.js";import{u as Te}from"./useBreakpoints-06419e03.js";const be={refetchOnMount:!1,refetchOnWindowFocus:!1,refetchOnReconnect:!1,staleTime:G};function Ae(e,x={}){const{account:a,isWalletReady:n}=L(),{networkId:m}=N(),c=w(()=>n.value),g=H(),l=w(()=>new g(C.network.addresses.vault,V.Vault__factory.abi,U.jsonProvider)),h=O(q.Account.RelayerApprovals(m,a,e)),f=async()=>e.value?await l.value.hasApprovedRelayer(a.value,e.value):!0,u=O({enabled:c,...be,...x});return Y(h,f,u)}const we=C.network.addresses.vault;function Ce(e,x=A(!0)){const a=A(!1),n=A(!1),m=A(!1),{getSigner:c,account:g}=L(),l=A(z[e]),{txListener:h}=ie(),{addTransaction:f}=ce(),{t:u}=$(),v=Ae(l),y=w(()=>m.value||(x.value?!!v.data.value:!0)),r=w(()=>v.isLoading.value||v.isError.value),s=w(()=>({label:u("transactionSummary.approveRelayer",[e]),loadingLabel:u("actionSteps.approve.loadingLabel"),confirmingLabel:u("confirming"),stepTooltip:u("approveRelayerTooltip"),action:_}));async function _(){try{a.value=!0;const R=await new K(c()).contract.sendTransaction({contractAddress:C.network.addresses.vault,abi:V.Vault__factory.abi,action:"setRelayerApproval",params:[g.value,l.value,!0]});return a.value=!1,n.value=!0,S(R),R}catch(p){return console.log(p),a.value=!1,n.value=!1,Promise.reject(p)}}async function S(p){f({id:p.hash,type:"tx",action:"approve",summary:u("transactionSummary.approveRelayer",[e]),details:{contractAddress:we,spender:l.value}}),m.value=await h(p,{onTxConfirmed:async()=>{n.value=!1,v.refetch()},onTxFailed:()=>{n.value=!1}})}return{action:s,init:a,approve:_,approving:n,approved:m,isUnlocked:y,loading:r}}let W=te;function Se(){return W||Q("Relayer"),W}var Re=(e=>(e.COWSWAP="Cowswap",e.LIDO="Lido",e.BATCH="Batch",e))(Re||{});const z={Cowswap:ue,Lido:C.network.addresses.lidoRelayer,Batch:C.network.addresses.batchRelayer},E=A("");function lt(e){const{account:x,getSigner:a,connector:n}=L(),{networkId:m}=N(),{t:c}=$(),{isGnosisSafeApp:g}=pe(),l=Ce(e),{supportSignatures:h}=M(),f={label:c("signRelayerApproval"),loadingLabel:c("checkWallet"),confirmingLabel:c("signingRelayerApproval"),stepTooltip:c("signRelayerApprovalTooltip"),action:v,isSignAction:!0},u=w(()=>{var y;return!h.value||g.value||me((y=n.value)==null?void 0:y.id)?l.action.value:f});async function v(){const y=Se(),r=z[e],s=a(),_=await s.getAddress(),S=await y.signRelayerApproval(r,_,s,V.Vault__factory.connect(C.network.addresses.vault,s));E.value=S}return se([x,m],()=>{E.value=""}),{relayerSignature:E,relayerApprovalAction:u,relayerApprovalTx:l}}const ke={class:"flex items-baseline"},Be=["textContent"],Ee=["innerHTML"],Le={key:0,class:"mt-6"},Ve={class:"flex items-baseline"},Oe=["textContent"],Pe=["textContent"],De={class:"flex mt-1"},We={class:"mt-6"},$e={class:"flex items-baseline"},Me=["textContent"],Ne=["textContent"],ze={key:1,class:"mt-6"},Ie={class:"flex items-baseline"},Fe=["textContent"],Ge=["innerHTML"],He={class:"flex mt-1"},Ue={class:"flex items-center px-1 rounded-lg border dark:border-gray-700 shadow-inner"},qe=t("div",{class:"px-2"},"minutes",-1);var Ye=(e=>(e[e.swap=0]="swap",e[e.invest=1]="invest",e))(Ye||{});const rt=ae({__name:"SwapSettingsPopover",props:{context:null,isGassless:{type:Boolean,default:!1}},setup(e){const x=e,{context:a}=ne(x),{transactionDeadline:n,setTransactionDeadline:m}=de(),{trackGoal:c,Goals:g}=X(),{ethereumTxType:l,setEthereumTxType:h}=fe(),{supportSignatures:f,setSupportSignatures:u}=M(),{isNarrowMobile:v}=Te();function y(){a.value===0?c(g.ClickSwapSettings):a.value===1&&c(g.ClickJoinPoolSettings)}return(r,s)=>{const _=J,S=Z,p=he,R=xe,I=ye,F=ge;return k(),oe(F,{fullscreen:i(v)},{activator:d(()=>[o(S,{circle:"",color:"white",size:"sm",class:"mb-2 text-secondary icon-spin-anim",onClick:y},{default:d(()=>[o(_,{name:"settings",size:"sm"})]),_:1})]),default:d(()=>[t("div",{class:le([{"pt-3":i(v)}])},[t("div",ke,[t("span",{class:"mb-2 font-medium",textContent:b(r.$t("slippageTolerance"))},null,8,Be),o(p,null,{activator:d(()=>[o(_,{name:"info",size:"xs",class:"-mb-px ml-1 text-gray-400"})]),default:d(()=>[t("div",{innerHTML:r.$t("marketConditionsWarning")},null,8,Ee)]),_:1})]),o(ve,{class:"mt-1"})],2),i(ee)?(k(),P("div",Le,[t("div",Ve,[t("span",{class:"mb-2 font-medium",textContent:b(r.$t("transactionType"))},null,8,Oe),o(p,null,{activator:d(()=>[o(_,{name:"info",size:"xs",class:"-mb-px ml-1 text-gray-400"})]),default:d(()=>[t("div",{textContent:b(r.$t("ethereumTxTypeTooltip"))},null,8,Pe)]),_:1})]),t("div",De,[o(R,{modelValue:i(l),"onUpdate:modelValue":[s[0]||(s[0]=T=>B(l)?l.value=T:null),i(h)],options:i(_e)},null,8,["modelValue","options","onUpdate:modelValue"])])])):D("",!0),t("div",We,[t("div",$e,[t("span",{class:"mb-2 font-medium",textContent:b(r.$t("useSignatures"))},null,8,Me),o(p,null,{activator:d(()=>[o(_,{name:"info",size:"xs",class:"-mb-px ml-1 text-gray-400"})]),default:d(()=>[t("div",{textContent:b(r.$t("useSignaturesTooltip"))},null,8,Ne)]),_:1})]),o(I,{modelValue:i(f),"onUpdate:modelValue":s[1]||(s[1]=T=>B(f)?f.value=T:null),name:"supportSignatures",onToggle:i(u)},null,8,["modelValue","onToggle"])]),e.isGassless&&i(a)===0?(k(),P("div",ze,[t("div",Ie,[t("span",{class:"mb-2 font-medium",textContent:b(r.$t("transactionDeadline"))},null,8,Fe),o(p,null,{activator:d(()=>[o(_,{name:"info",size:"xs",class:"-mb-px ml-1 text-gray-400"})]),default:d(()=>[t("div",{innerHTML:r.$t("transactionDeadlineTooltip")},null,8,Ge)]),_:1})]),t("div",He,[t("div",Ue,[re(t("input",{"onUpdate:modelValue":s[2]||(s[2]=T=>B(n)?n.value=T:null),class:"w-8 text-right bg-transparent",placeholder:"20",type:"number",step:"1",min:"0","on:update:modelValue":s[3]||(s[3]=(...T)=>i(m)&&i(m)(...T))},null,544),[[j,i(n)]])]),qe])])):D("",!0)]),_:1},8,["fullscreen"])}}});export{Re as R,Ye as S,rt as _,lt as a,Ae as b,Ce as u};
//# sourceMappingURL=SwapSettingsPopover.vue_vue_type_style_index_0_lang-2f86f757.js.map
