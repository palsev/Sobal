import{bI as g,a5 as w,au as h}from"./BalBtn-a3a093af.js";import{c as m}from"./connector-d867b6ec.js";const P=g(y,1e3);function y({error:e,action:t="unknown",msgPrefix:s="",context:n={},query:i}){if(!S(e,i))return;console.error(e);const r=k(e),c=L(e,r,s),u=e.metadata||{},d=b(t,n,r,u),E=C(e),p=v(c,t,e);w(p,{...n,extra:{...n==null?void 0:n.extra,...u,balError:r,originalError:E},tags:d})}function L(e,t,s){let n="";typeof e.reason=="string"?n=e.reason:typeof e.message=="string"?n=e.message:typeof e.case=="string"?n=e.case:typeof e.cause.message=="string"?n=e.cause.message:typeof e=="string"?n=e:n="Unable to extract error message";const i=t?`BAL#${t}`:"";return`${s} ${i} ${n}`}function k(e){const s=(e.reason||"no reason available").match(/BAL#[0-9]{3}/g);return s&&s[0]?s[0].slice(-3):null}function C(e){var t,s;if((t=e.data)!=null&&t.originalError)return(s=e.data)==null?void 0:s.originalError;if(e.cause instanceof Error)return e.cause}function b(e,t,s,n){const i={...t==null?void 0:t.tags,action:e};return s&&(i.balError=s),n!=null&&n.chainId&&(i.chainId=`${n.chainId}`),n.action&&(i.action=n.action),i}class a extends Error{constructor(t,s,n){super(s),n instanceof Error&&n.stack&&(this.stack=n.stack),this.name=t,this.cause=n}}function v(e,t,s){switch(t){case"swap":return new a("BatchSwapError",e,s);case"invest":return new a("JoinPoolError",e,s);case"withdraw":return new a("ExitPoolError",e,s);case"createPool":return new a("CreatePoolError",e,s);case"userGaugeCheckpoint":return new a("CheckpointGaugeError",e,s);case"sync":return new a("VebalSyncError",e,s);case"extendLock":return new a("ExtendLockError",e,s);case"unlock":return new a("UnlockError",e,s);case"stake":return new a("StakeError",e,s);case"unstake":return new a("UnstakeError",e,s);default:return new a("Error",e,s)}}function o(e,t){var s,n,i;return e?typeof e=="string"&&t.some(r=>r.test(e.toLowerCase()))||e.message&&t.some(r=>r.test(e.message.toLowerCase()))||typeof e.reason=="string"&&t.some(r=>r.test(e.reason)||r.test(e.reason.toLowerCase()))||(s=e.cause)!=null&&s.message&&t.some(r=>r.test(e.cause.message.toLowerCase()))||typeof e.cause=="string"&&t.some(r=>r.test(e.cause.toLowerCase()))||e.b&&t.some(r=>r.test(e.b.toLowerCase()))||e!=null&&e.code&&e.code===4001||(n=e.cause)!=null&&n.code&&((i=e.cause)==null?void 0:i.code)===4001?!0:e.cause instanceof Error?f(e.cause):!1:!1}function f(e){return o(e,[/rejected/,/user rejected transaction/,/request rejected/,/user rejected methods./,/user rejected the transaction/,/user rejected the request/,/rejected by user/,/user canceled/,/cancelled by user/,/transaction declined/,/transaction was rejected/,/user denied transaction signature/,/user disapproved requested methods/,/canceled/,/cancelled/,/user rejected signing/,/user cancelled/,/no matching key/])}function l(e){return o(e,[/insufficient funds for gas/,/the signed fee is insufficient/,/EffectivePriorityFeePerGas too low/i,/Комиссия за газ обновлена/i,/insufficient eth to pay the network fees/,/insufficient funds for intrinsic transaction cost/])}function R(e){return o(e,[/invalid rpc url/,/nonce has already been used/])}function j(e){return o(e,[/execution reverted: ERR_NEEDS_REFILL/i,/execution reverted: ERR_DRIP_THROTTLE/i])}function B(e){return o(e,[/ResourceExhausted/i])}function I(e){return f(e)||l(e)||R(e)}function T(e){return e?e.failureCount.value<=1:!0}function S(e,t){return!m.isDevEnv&&!I(e)&&!j(e)&&!B(e)&&T(t)}function U(){const{t:e}=h(),t={title:e("transactionErrors.gasTooLow.title"),description:e("transactionErrors.gasTooLow.description")},s={title:e("transactionErrors.cannotEstGas.title"),description:e("transactionErrors.cannotEstGas.description")},n={title:e("transactionErrors.slippage.title"),description:e("transactionErrors.slippage.description")};function i(c=""){return{title:e("transactionErrors.default.title"),description:c.trim()}}function r(c){return l(c)||o(c,[/-32010/])?t:o(c,[/BAL#507/i])||o(c,[/BAL#505/i])?n:o(c,[/UNPREDICTABLE_GAS_LIMIT/i])?s:i(typeof c=="string"?c.trim():c.message??"")}return{formatErrorMsg:r}}export{P as c,I as i,U as u};
//# sourceMappingURL=errors-e4e66976.js.map
