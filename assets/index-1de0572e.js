import{c,a as V}from"./_commonjsHelpers-87174ba5.js";var L={},y={},T={},_={},m={};const K="@gnosis.pm/safe-apps-sdk",F="4.0.0",N="SDK developed to integrate third-party apps with Safe-Multisig app.",$="dist/src/index.js",x="dist/src/index.d.ts",G=["dist/**/*","README.md"],X=["Gnosis","sdk","apps"],U={test:"jest","format-dist":`sed -i '' 's/"files":/"_files":/' dist/package.json`,build:"yarn rimraf dist && tsc && yarn format-dist",lint:"tslint -p tsconfig.json",prepublishOnly:"yarn build"},W="Gnosis (https://gnosis.io)",z="MIT",J={},Q={"@types/jest":"^26.0.23","@types/node":"^15.12.4",rimraf:"^3.0.2"},Y={type:"git",url:"git+https://github.com/gnosis/safe-apps-sdk.git"},Z={url:"https://github.com/gnosis/safe-apps-sdk/issues"},ee="https://github.com/gnosis/safe-apps-sdk#readme",te={name:K,version:F,description:N,main:$,typings:x,_files:G,keywords:X,scripts:U,author:W,license:z,dependencies:J,devDependencies:Q,repository:Y,bugs:Z,homepage:ee};var se=c&&c.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(m,"__esModule",{value:!0});m.getSDKVersion=void 0;const ne=se(te),ae=()=>ne.default.version.slice(0,5);m.getSDKVersion=ae;var b={};Object.defineProperty(b,"__esModule",{value:!0});b.generateRequestId=void 0;const re=e=>e.toString(16).padStart(2,"0"),oe=e=>{const t=new Uint8Array((e||40)/2);return window.crypto.getRandomValues(t),Array.from(t,re).join("")},ie=()=>typeof window<"u"?oe(10):new Date().getTime().toString(36);b.generateRequestId=ie;Object.defineProperty(_,"__esModule",{value:!0});_.MessageFormatter=void 0;const ce=m,ue=b;class v{}_.MessageFormatter=v;v.makeRequest=(e,t)=>({id:ue.generateRequestId(),method:e,params:t,env:{sdkVersion:ce.getSDKVersion()}});v.makeResponse=(e,t,a)=>({id:e,success:!0,version:a,data:t});v.makeErrorResponse=(e,t,a)=>({id:e,success:!1,error:t,version:a});var h={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Methods=void 0,function(t){t.sendTransactions="sendTransactions",t.rpcCall="rpcCall",t.getSafeInfo="getSafeInfo",t.getTxBySafeTxHash="getTxBySafeTxHash",t.getSafeBalances="getSafeBalances"}(e.Methods||(e.Methods={}))})(h);(function(e){var t=c&&c.__createBinding||(Object.create?function(o,s,r,n){n===void 0&&(n=r),Object.defineProperty(o,n,{enumerable:!0,get:function(){return s[r]}})}:function(o,s,r,n){n===void 0&&(n=r),o[n]=s[r]}),a=c&&c.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&t(s,o,r)};Object.defineProperty(e,"__esModule",{value:!0});const i=_;class l{constructor(s=null,r=!1){this.allowedOrigins=null,this.callbacks=new Map,this.debugMode=!1,this.isValidMessage=({origin:n,data:u,source:g})=>{const B=!u,j=g===window.parent,I=(typeof u.version<"u"&&parseInt(u.version.split(".")[0]))>=1;let O=!0;return Array.isArray(this.allowedOrigins)&&(O=this.allowedOrigins.find(H=>H.test(n))!==void 0),!B&&j&&I&&O},this.logIncomingMessage=n=>{console.info(`Safe Apps SDK v1: A message was received from origin ${n.origin}. `,n.data)},this.onParentMessage=n=>{this.isValidMessage(n)&&(this.debugMode&&this.logIncomingMessage(n),this.handleIncomingMessage(n.data))},this.handleIncomingMessage=n=>{const{id:u}=n,g=this.callbacks.get(u);g&&(g(n),this.callbacks.delete(u))},this.send=(n,u)=>{const g=i.MessageFormatter.makeRequest(n,u);if(typeof window>"u")throw new Error("Window doesn't exist");return window.parent.postMessage(g,"*"),new Promise((B,j)=>{this.callbacks.set(g.id,p=>{if(!p.success){j(new Error(p.error));return}B(p)})})},this.allowedOrigins=s,this.debugMode=r,window.addEventListener("message",this.onParentMessage)}}e.default=l,a(h,e)})(T);var S={};Object.defineProperty(S,"__esModule",{value:!0});S.TXs=void 0;const R=h;class le{constructor(t){this.communicator=t}async getBySafeTxHash(t){if(!t)throw new Error("Invalid safeTxHash");return(await this.communicator.send(R.Methods.getTxBySafeTxHash,{safeTxHash:t})).data}async send({txs:t,params:a}){if(!t||!t.length)throw new Error("No transactions were passed");const i={txs:t,params:a};return(await this.communicator.send(R.Methods.sendTransactions,i)).data}}S.TXs=le;var P={},w={};Object.defineProperty(w,"__esModule",{value:!0});w.RPC_CALLS=void 0;w.RPC_CALLS={eth_call:"eth_call",eth_getLogs:"eth_getLogs",eth_getBalance:"eth_getBalance",eth_getCode:"eth_getCode",eth_getBlockByHash:"eth_getBlockByHash",eth_getBlockByNumber:"eth_getBlockByNumber",eth_getStorageAt:"eth_getStorageAt",eth_getTransactionByHash:"eth_getTransactionByHash",eth_getTransactionReceipt:"eth_getTransactionReceipt"};Object.defineProperty(P,"__esModule",{value:!0});P.Eth=void 0;const d=w,de=h,f={defaultBlockParam:(e="latest")=>e,returnFullTxObjectParam:(e=!1)=>e,blockNumberToHex:e=>Number.isInteger(e)?`0x${e.toString(16)}`:e};class fe{constructor(t){this.communicator=t,this.call=this.buildRequest({call:d.RPC_CALLS.eth_call,formatters:[null,f.defaultBlockParam]}),this.getBalance=this.buildRequest({call:d.RPC_CALLS.eth_getBalance,formatters:[null,f.defaultBlockParam]}),this.getCode=this.buildRequest({call:d.RPC_CALLS.eth_getCode,formatters:[null,f.defaultBlockParam]}),this.getStorageAt=this.buildRequest({call:d.RPC_CALLS.eth_getStorageAt,formatters:[null,f.blockNumberToHex,f.defaultBlockParam]}),this.getPastLogs=this.buildRequest({call:d.RPC_CALLS.eth_getLogs}),this.getBlockByHash=this.buildRequest({call:d.RPC_CALLS.eth_getBlockByHash,formatters:[null,f.returnFullTxObjectParam]}),this.getBlockByNumber=this.buildRequest({call:d.RPC_CALLS.eth_getBlockByNumber,formatters:[f.blockNumberToHex,f.returnFullTxObjectParam]}),this.getTransactionByHash=this.buildRequest({call:d.RPC_CALLS.eth_getTransactionByHash}),this.getTransactionReceipt=this.buildRequest({call:d.RPC_CALLS.eth_getTransactionReceipt})}buildRequest({call:t,formatters:a}){return async i=>{a&&Array.isArray(i)&&a.forEach((s,r)=>{s&&(i[r]=s(i[r]))});const l={call:t,params:i};return(await this.communicator.send(de.Methods.rpcCall,l)).data}}}P.Eth=fe;var M={};Object.defineProperty(M,"__esModule",{value:!0});M.Safe=void 0;const C=h;class ge{constructor(t){this.communicator=t}async getInfo(){return(await this.communicator.send(C.Methods.getSafeInfo,void 0)).data}async experimental_getBalances({currency:t="usd"}={}){return(await this.communicator.send(C.Methods.getSafeBalances,{currency:t})).data}}M.Safe=ge;var he=c&&c.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(y,"__esModule",{value:!0});const _e=he(T),me=S,pe=P,ye=M;let be=class{constructor(t={}){const{whitelistedDomains:a=null,debug:i=!1}=t;this.communicator=new _e.default(a,i),this.eth=new pe.Eth(this.communicator),this.txs=new me.TXs(this.communicator),this.safe=new ye.Safe(this.communicator)}};y.default=be;var A={},D={};Object.defineProperty(D,"__esModule",{value:!0});var E={};Object.defineProperty(E,"__esModule",{value:!0});var k={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Operation=void 0,function(t){t[t.CALL=0]="CALL",t[t.DELEGATE=1]="DELEGATE"}(e.Operation||(e.Operation={}))})(k);var q={};Object.defineProperty(q,"__esModule",{value:!0});(function(e){var t=c&&c.__createBinding||(Object.create?function(i,l,o,s){s===void 0&&(s=o),Object.defineProperty(i,s,{enumerable:!0,get:function(){return l[o]}})}:function(i,l,o,s){s===void 0&&(s=o),i[s]=l[o]}),a=c&&c.__exportStar||function(i,l){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(l,o)&&t(l,i,o)};Object.defineProperty(e,"__esModule",{value:!0}),a(D,e),a(E,e),a(k,e),a(q,e)})(A);(function(e){var t=c&&c.__createBinding||(Object.create?function(s,r,n,u){u===void 0&&(u=n),Object.defineProperty(s,u,{enumerable:!0,get:function(){return r[n]}})}:function(s,r,n,u){u===void 0&&(u=n),s[u]=r[n]}),a=c&&c.__exportStar||function(s,r){for(var n in s)n!=="default"&&!Object.prototype.hasOwnProperty.call(r,n)&&t(r,s,n)},i=c&&c.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(e,"__esModule",{value:!0}),e.getSDKVersion=void 0;const l=i(y);e.default=l.default,a(y,e),a(A,e),a(h,e),a(_,e);var o=m;Object.defineProperty(e,"getSDKVersion",{enumerable:!0,get:function(){return o.getSDKVersion}})})(L);const Pe=V(L);export{Pe as S};
//# sourceMappingURL=index-1de0572e.js.map
