import{av as T,au as U,aq as I,bu as B,b3 as D,b2 as M}from"./BalBtn-a3a093af.js";import{t as V}from"./useTransactions-19512b92.js";import{S as j,c as z,Z as E}from"./connector-d867b6ec.js";var i=(r=>(r[r.AddLiquidity=0]="AddLiquidity",r[r.Locking=1]="Locking",r[r.Staking=2]="Staking",r[r.Swapping=3]="Swapping",r[r.Unapprove=4]="Unapprove",r))(i||{});function G(){const{refetchAllowances:r,approvalsRequired:S,approvalRequired:f,getToken:w,injectSpenders:k,allowanceFor:y}=T(),{t}=U(),{getSigner:L}=I(),{addTransaction:b}=V();function m(n,a){switch(n){case i.Locking:return t("transactionSummary.approveForLocking",[a]);case i.Staking:return t("transactionSummary.approveForStaking",[a]);case i.Swapping:return t("transactionSummary.approveForSwapping",[a]);case i.Unapprove:return t("transactionSummary.unapprove",[a]);default:return t("transactionSummary.approveForInvesting",[a])}}function q(n,a){switch(n){case i.Locking:return t("transactionSummary.tooltips.approveForLocking",[a]);case i.Staking:return t("transactionSummary.tooltips.approveForStaking",[a]);case i.Swapping:return t("transactionSummary.tooltips.approveForSwapping",[a]);case i.Unapprove:return t("transactionSummary.tooltips.unapprove",[a]);default:return t("transactionSummary.tooltips.approveForInvesting",[a])}}async function c(n){await k([n]),await r()}async function F(n,a,e=!1){return e||await c(a),S(n,a)}async function R(n,a){return E(n.amount).eq(0)?!0:(await c(a),!f(n.address,n.amount,a))}async function g({token:n,normalizedAmount:a,spender:e,actionType:o,forceMax:u=!0}){const p=u?B.toString():D(a,n.decimals).toString(),s=await new M(L()).contract.sendTransaction({contractAddress:n.address,abi:["function approve(address spender, uint256 amount) public returns (bool)"],action:"approve",params:[e,p]});return b({id:s.hash,type:"tx",action:"approve",summary:m(o,n.symbol),details:{contractAddress:n.address,spender:e}}),s}function h(n,a){var e;return!!((e=z.network.tokens.DoubleApprovalRequired)!=null&&e.includes(n.address)&&y(n.address,a).gt(0))}function v({token:n,normalizedAmount:a,spender:e,actionType:o,forceMax:u=!0}){return{label:m(o,n.symbol),loadingLabel:t("investment.preview.loadingLabel.approval"),confirmingLabel:t("confirming"),stepTooltip:q(o,n.symbol),action:()=>g({token:n,normalizedAmount:a,spender:e,actionType:o,forceMax:u}),postActionValidation:()=>R({address:n.address,amount:a},e),actionInvalidReason:{title:t("actionSteps.approve.invalidReason.title"),description:t("actionSteps.approve.invalidReason.description")}}}async function x({amountsToApprove:n,spender:a,actionType:e,forceMax:o=!0,skipAllowanceCheck:u=!1}){const p=await F(n,a,u);return j.flatten(p.map(d=>{const s=w(d.address),l=[];return h(s,a)&&l.push(v({token:s,normalizedAmount:"0",spender:a,actionType:i.Unapprove,forceMax:!1})),l.push(v({token:s,normalizedAmount:d.amount,spender:a,actionType:e,forceMax:o})),l}))}return{approveToken:g,getTokenApprovalActions:x,updateAllowancesFor:c}}export{i as A,G as u};
//# sourceMappingURL=useTokenApprovalActions-7a65b699.js.map
